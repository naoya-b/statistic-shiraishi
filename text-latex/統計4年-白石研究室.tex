\documentclass[dvipdfmx,autodetect-engine]{jsarticle}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{enumitem}
\begin{document}

\title{Ruppret・Matteson-Statistics}
\author{伴 尚哉\thanks{\texttt{naoyayg30@keio.jp}}\\61715382\\慶應義塾大学理工学部数理科学科 白石研究室}
\date{\today}
\maketitle

\section{Introduction}
\ 略
\section{利益率}
\subsection{導入}
\ 投資の目的はもちろん利益を出すことである。投資で利益を得るかどうかは、自分の資産の量と投資の値段に依存する。投資家は、収入に大変興味があり、それは初期投資に大きく関わる。
利益率は、初期値段の何分の1かといった形で表記される。
\subsubsection{Net Return(純利益率)}
\ $P_{t}$を時間$t$での資産額とする。配当がないと仮定すると、$t-1 ~ t$時間までの純利益率は以下の式で表せる。
\begin{align*}
R_{t} = \frac{P_{t}}{P_{t-1}}-1 = \frac{P_{t} - P_{t-1}}{P_{t-1}}
\end{align*}
ここで、分子の$P_{t} - P_{t-1}$は、期間内の利益や収入を表す。もし、値が負なら資産を失ったことを表す。分母の$P_{t-1}$は期間内での初期の投資額を表す。それゆえ、純利益率というのは、相対的な収入・利益率等と見ることもできる。$\\ $
\ 試算を持つことによる利益率というのは以下の式で表せられる。
\begin{align}
revenue = initial investment × net return
\end{align}
\ 例えば、初期資産が$\$10000$で、純利益率が$6\%$としたら、$\$600$の収入を得ることになる。なぜなら、$P_{t} \leq 0 $だからである。また、$R_{t} \leq -1$である。起こりえる最も悪いリターン値は、-1の時、つまり$100\%$失うことであり、資産の価値がなくなるときにおこる。

\subsubsection{Gross Returns(総利益率)}
\ 単純な総利益率は以下の式で定義できる。
\begin{align}
\frac{P_{t}}{P_{t-1}} = 1 + R_{t}
\end{align}
\ 例えば、$P_{t}=2 \; and \; p_{t+1} = 2.1$ならば、$1 + R_{t+1} = 1.05 (= 105\%)$となり、$R_{t+1} = 0.05 (5\%)$となる。時点tでの最終的な資産は、時点t-1での初期資産に総利益率（Gross Return)をかけたものとなる。
別の方法で表記すると、もし、時点t-1での初期資産が$X_{0}$ならば、時点tでの資産は$X_{0}(1 + R_{t})$となる。$\\ $
\ 利益率というのは、単位がない - つまり、ドルやセントといった単位に依存しないのである。しかし、利益率に単位が必要ないわけではない。利益率の単位とは時間である。つまり、時間、曜日といったものに依存するのだ。
例えば、時間tが年単位で計測されているならば、より正確に書くと純利益率は$5\% / year$となる。　$\\ $
\ 直近$k$期間での総利益率のことを、k-期間ごとの総利益率（つまり、時点t-k~tまでの期間)と呼び、以下で定義される。
\begin{align}
1 + R_{t}(k) = \frac{P_{t}}{P_{t-k}} &= \left(\frac{P_{t}}{P_{t-1}}\right)\left(\frac{P_{t-1}}{P_{t-2}}\right)\cdots\left(\frac{P_{t-k+1}}{P_{t-k}}\right) \\ \nonumber
                                     &= (1+R_{t})\cdots(1 + R_{t-k+1})
\end{align}
ただし、時点kでの純利益率を$R_{k}$と表す。

\subsubsection{log Returns(対数利益率)}
\ 対数利益率は、連続的に組み込まれる利益とも呼ばれ、$r_{t}$で表記される。定義は以下のとおりである。
\begin{align}
r_{t} = \log(1 + R_{t}) = \log \left(\frac{P_{t}}{P_{t-1}}\right) = p_{t} - p_{t-1}
\end{align}
ただし、$p_{t} = \log(P_{t})$であり、対数資産と呼ばれる。$\\ $
\ 対数資産は、大まかには利益率と同じだとみることができる。なぜなら、$x$が小さい時、$\log(1+x) \approx x$と近似できるからである（本書の図(2.1)参考）。例えば利益率が$10\%$以下のとき、
つまり$|x| < 0.1$のとき、図を見れば$\log(1+x)$が、$x$にとても近づくことがわかる。$\\ $
\ 例えば、$5\%$の利益率というのは、$4.88\%$の対数利益率と同じである。なぜなら、$\log(1+0.05) = 0.0488$だからだ。
同様に、$-5\%$の利益率というのは、$-5.13\%$の対数利益率と同じである。なぜなら、$\log(1-0.05) = -0.0513$だからだ。どちらの例でも、$r_{t} = \log(1 + R_{t}) \approx R_{t}$が言える。
もう一つの例は略すが、対数利益というのが純利益と大変近くなることがわかる。利益率は、短期間では対数利益率とほぼ等しくなるくらい小さくなることから、
年利益率と同様、日利益率も対数利益率と利益率が等しいとみることができる一方、10年といった長い期間では、二つを等しく扱う必要はない。$\\ $
\ 利益率と対数利益率は同じ正負の符号を持つ。対数利益率は、正の時は利益率より小さく、負の時は利益率より大きく出る。両者の違いは、どちらの値も負の値に大きかった時に顕著になる。例えば、利益率が$-1$のとき、対数利益率は$-\infty$となる。このとき、すべての資産を失っている。　$\\ $
\ 対数利益率をつかう一つのメリットは、複数の期間にまたがったとき簡単になることである。k期間での対数利益率は、1期間での対数利益率の和で書ける。よって、k期間での対数利益率は
\begin{align}
r_{t}(k) &= \log \{1 + R_{t}(k)\}  \nonumber \\
         &= \log \{(1+R_{t}) \cdots (1+R_{t-k+1})\} \nonumber \\
         &= \log(1 + R_{t}) + \cdots + \log(1 + R_{t-k+1}) \nonumber \\
         &= r_{t} + r_{t-1} + \cdots + r_{t-k+1} \nonumber
\end{align}
\subsection{配当の配布}
\ 多くの大企業の株では、利益率を計算したのを考慮にいれ配当を配る。同様に、金利も払う。もし配当や金利$D_{t}$が時点$t$の前に払われたとする。その時、時点$t$での総利益は以下のように定義できる。
\begin{align}
1 + R_{t} = \frac{P_{t}+D_{t}}{P_{t-1}}
\end{align}
よって、純利益は$R_{t} = (P_{t} + D_{t})/P_{t-1} - 1$となる。そして、対数利益率は、$r_{t} = \log(1+R_{t}) = \log(P_{t} + D_{t}) - \log(P_{t-1})$となる。
複数期間にまたがる総利益率は、短期間の利益率の集まりでかけ、つまり、
\begin{align}
1 + R_{t}(k) &= \left(\frac{P_{t} + D_{t}}{P_{t-1}}\right)\left(\frac{P_{t-1} + D_{t-1}}{P_{t-2}}\right)\cdots\left(\frac{P_{t-k+1} + D_{t-k+1}}{P_{t-k}}\right) \nonumber \\
&=(1+R_{t})(1+R_{t-1})\cdots(1+R_{t-k+1})
\end{align}
もし、期間$s-1 \sim s$で配当がなかったなら、ある時点$s$で$D_{s} = 0$となる。
同様に、期間$k$での対数利益率は、
\begin{align*}
r_{t}(k) &= \log(1+R_{t}(k)) = \log(1+R(t)) + \cdots + \log(1+R(t-k+1)) \nonumber \\
&=\log\left(\frac{P_{t} + D_{t}}{P_{t-1}}\right)+\cdots+\log\left(\frac{P_{t-k+1} + D_{t-k+1}}{P_{t-k}}\right)
\end{align*}

\subsection{ランダムウォークモデル}
\ ランダムウォークという仮説は、期間ごとの対数利益率$r_{t} = \log(1 + R_{t})$は独立であると述べている。なぜなら、
\begin{align*}
1 + R_{t}(k) &= (1+R_{t})\cdots(1+R_{t-k+1}) \\
&= \exp(r_{t}) \cdots \exp(r_{t-k+1}) \\
&= \exp(r_{t}\cdots r_{t-k+1})
\end{align*}
であり、
\begin{align}
\label{b}
\log\{1+R_{t}(k)\} = r_{t} + \cdots + r_{t-k+1}
\end{align}
となるからである。$\\ $
\ よく、対数利益率は一定の平均・分散の正規分布であると考えられることが多い。正規分布の再生成から、単期間の対数利益率が複数機関の対数利益率を表す。この仮定の下では、
$\log\{1+R_{t}(k)\}$は$N(k\mu,k\sigma^{2})$に従う。
\newpage
\subsubsection{ランダムウォーク}
\ 式(\ref{b})は、ランダムウォークモデルの一つの例である。今、$Z_{1},Z_{2},\ldots$が平均$\mu$、分散$\sigma$に独立同一に従うとする。このとき、$S_{0}$を任意の始点とする。
\begin{align}
\label{c}
\S_{t} = S_{0} + Z_{1} + \cdots + Z_{t},\; t\geq 1.
\end{align}
とすると、式(\ref{c})より、$S_{t}$は$t$ステップ後の位置となる。$\\ $
\ $S_{0},S_{1},\ldots$という過程は、ランダムウォークと呼ばれ、$Z_{1},Z_{2}\ldots$を過程と呼ぶ。もしこの仮定が、標準正規分布なら。標準ランダムウォークと呼ばれる。
$S_{0}$が与えられた下での$S_{t}$の期待値と分散はそれぞれ$E(S_{t}|S_{0}) = S_{0} + \mu t$と$Var(S_{t}|S_{0}) = \sigma^{2}t$となる。
このとき、パラメータ$\mu$は傾向とよばれ、ランダムウォークの動く方向を決める。パラメータ$\sigma$は変動と呼ばれ、$S_{t}$の条件付き期待値からどれほど値が広がるかというのを表している。
$S_{0}$が与えられて時の$S_{t}$が$68\%$の確率で含まれる位置は$(S_{0} + \mu t) \pm \sigma \sqrt{t}$と書ける。$68\%$範囲は、$\sqrt{t}$が増えるごとに大きくなっていく。
図2.2を見ると、ランダムウォークの位置の$t=0$の時の予測は、少し時間がたった後の予測より狭いことがわかる。
\subsection{幾何ランダムクォーク}
\ $\log \{ 1 + R_t{k}\} = r_{t} + \cdots + r_{t-k+1}$であることを使うと、以下が成り立つ。
\begin{align}
\frac{P_{t}}{P_{t-k}} = 1 + R_{t}(k) = exp(r_{t} + \cdots + r_{t-k+1})
\end{align}
よって、$k=t$ととると、
\begin{align}
P_{t} = P_{0}exp(r_{t} + r_{t-1} + \cdots + r_{1})
\end{align}
が成り立つ。この過程のことを幾何ランダムウォークもしくは$\exp$ランダムウォークと呼ぶ。もし、$r_{i}$が独立同一に$N(\mu,\sigma^2)$に従う場合、$P_{t}$はすべての時点で対数正規分布となる。
このとき、パラメータ$(\mu,\sigma^{2})$の対数正規・幾何ランダムウォークと呼ばれる。A9.4は略。また、$mu$も対数正規・幾何ランダムウォークの対数傾向と呼ばれる。

\subsubsection{対数価格は、対数正規幾何ランダムウォークに従うか？}
\ 金融数理の多くの仕事では、価格は対数正規幾何ランダムウォークか、連続時間でのブラウン運動に従うと考えられている。なので、自然な疑問として、この仮定が一般的に正しいのかどうかというのがある。
そして、その答えはノーである。対数正規・幾何ランダムウォークは二つの仮定がある。一つ目は、対数利益率は離散値であること・二つ目は、対数利益率は独立であることである。$\\ $
\ 4章・5章では、複数機関における対数利益率の周辺分布について述べる。結論としては、対数利益の密度関数のほうが利益の密度関数より鈴方をしている一方で、裾は対数利益のほうが広いのである。
典型的には、パラメータの自由度4~6の小さい時のt分布は、一般的な利益のモデルより当てはまりが良い。しかし、対数利益分布ではt分布とほぼ同型である。
\ 独立性の仮定も同様に厳しいものである。まず第一に、利益率にはいくつかの相関がある。しかし、一般には、この相関は極めて小さいものである。もっと深刻なものとして、volality-clusteringがある。
これは、大きな変化の後にはしばらく大きな変化が来やすいということだ。このvolality-clusteringは、平方利益率を見れば関係をつかめやすい。$\\ $
\ しかし、章の頭の仮定を切って捨てる前に、Boxさんの発言を思い出すのが大事だ。つまり、「一つのモデルとして正しいものはないが、便利なものはいくつかある」のだ。先の仮定は、有名な"ブラックショールズ方程式"を導出するのに役に立つ。
\subsection{参考文献}
略
\subsection{R}
略
\section{Fixed Income Securitied(確定利子付証券)}
\subsection{導入}
\ 企業は株や債券を売ることで会計を成り立たせている。公開された株を持つことは、その企業の一部のオーナーであるということだ。株主は、企業の利益も損失も一緒に請け負うのだ。
一方、債券は少し違う。もしあなたが債券を買ったなら、企業にローンを貸していることになる。しかしローンと違う点は、債券は売買ができるところである。企業は元本を返金するだけでなく、
債券に紐づけられた利息も払う必要がある。また、債券保持者は、利息ではなく確定利子を受け取ることもできる。これらの理由から、債券は、"確定利子付証券"とも呼ばれる。$\\ $
\ 債券は安全で変動がすくないと思われていてるが、以下はそうでない場合だ。多くの債券は5,10,20年と長い期間である。もし、破産しない企業の債券を買ったり、アメリカの国債を買えば、
あなたが期限まで債券を持っている限りあなたの債券からの収入は保証される。もし、期限前に売ってしまうと、その時の債券の値段に依存した額しかもらうことができない。
債券の値段は金利と逆の方向に動く。つまり、金利が低くなると債券の値段は上がるのだ。長期間の債券はこの影響をより受けやすい。あなたの債券の利率は変わらないものの、債権全体の利率は変動する。
つまり、あなたが持っている債券の値段も変動するのだ。例えば、あなたが$5\%$の金利が払われる債券をかったとして、金利が$6\%$に上がったとする。すると、あなたの債券は新しい債券より低条件である。
結果として、あなたの債券の価値は減少する。ここで売れば、あなたの損失となるのだ。$\\ $
\ 債券の金利はその持ってる期間に依存する。例えば、3か月持てば$4\%$なのが、2年なら$5\%$といったかたちである。このように、どうやって金利が変化していくかを、この章では述べる。
\subsection{Zero-Coupon Bonds(利息がない債券)}
\ 利息がない債券とは、純割引積や"zeros"として呼ばれる金利や特典が満期まで払われない債券のことである。この債券は、満期に払われる表額や譜面価格があり、その表額より安い値段で売られている。
なぜなら、ゼロ割積だからである。$\\ $
\ 例えば、満期20年のゼロ割積で表額が$1000$ドルで年間$6\%$利率が含まれていくとする。つまり、この債券の現在価格は
\begin{align*}
\frac{1000}{(1.06)^{20}} = 311.8
\end{align*}
となる。年利は$6\%$だが、半期ごとに組み込まれている場合、
\begin{align*}
\frac{1000}{(1.03)^{20}} = 306.56
\end{align*}
となる。もし連続時間ならば
\begin{align*}
\frac{1000}{\exp((0.06)^{20})} = 301.19
\end{align*}
となる。
\subsubsection{値段や利益は金利によって変動する}
\ 具体的に、半年ごとに組み込まれる場合について考える。先の例のゼロ割債を$305.56$ドルで買ったとし、半年後に金利が$7\%$に上がったとする。このとき、債券の現価は
\begin{align*}
\frac{1000}{(1.035)^{39}} = 261.41
\end{align*}
となる。つまり、あなたの債権の価値は$45$ドル近く落ちたのだ。$20$年もてば$1000$ドル払われるが、今売ってしまうと$45$ドル損してしまう。半期で$-45/306 = -14.8\%$の損である。
年間では$29\%$近い損だ。たった金利が$1\%$あがっただけなのにだ。つまり、金利が上がると債券の値段が下がるのだ。逆に$1\%$下がれば、年で$19\%$利益があることになり、ステイなら年$6\%$の利益のままである。しかし、たとえ金利が上がろうと下がろうと$20$年持ち続ければ$1000$ドルという金額は保証されているのだ。(本書からかなり省略)
\subsubsection{一般式}
\ ゼロ割債券の値段は以下で与えられる。
\begin{align*}
PRICE = PAR(1 + r)^{-T}
\end{align*}
となり、もし年率$r$で半期ごとに組み込まれるなら
\begin{align*}
PRICE = PAR(1 + r/2)^{-T/2}
\end{align*}
となる。
\subsection{利息付債権}
\ 利息付債権とは、定期的に金利が払われる債券である。この債券は大体譜面価格かそれに近い価格で売られる。満期になれば、債券の譜面通りの額と最後の金利が払われる。例を一つ出す。
譜面額1000ドルで満期20年、年利が6$\%$で半期ごとに払われる債券を考える。つまり、$3\%$が年利に組み込まれる。各年で30ドル配られるとする。債券保持者が40年間この金利を受け取るとすると、
20年後に1000ドルが帰ってくる。これは以下の式からもわかる。
\begin{align*}
\sum_{t=1}^{40}\frac{30}{(1.03)^{t}} + \frac{1000}{(1.03)^40} = 1000
\end{align*}
6か月後には、もし金利が変わらなければ、債券の価値は以下のようになっている。
\begin{align*}
\sum_{t=1}^{30}\frac{30}{(1.03)^{t}} + \frac{1000}{(1.03)^39} = 1030
\end{align*}
これで、期待通り年利6$\%$の半年分の利益が含まれていることがわかる。もし、金利が途中で$7\%$に変わったとき、半年後の価値は
\begin{align*}
\sum_{t=1}^{30}\frac{30}{(1.035)^{t}} + \frac{1000}{(1.035)^39} = (1.035)\left(sum_{t=1}^{40}\frac{30}{(1.035)^{t}} + \frac{1000}{(1.035)^40}\right) = 924.49
\end{align*}
つまり、年間の利率は
\begin{align*}
2\left(\frac{924.49 - 1000}{1000}\right) = -15.1\%
\end{align*}
となっている。もし、金利が$5\%$に落ちたなら、半年後には同様の計算方法で$1153.70$ドルとなり、年利は$30.72\%$となる。
\subsubsection{一般式}
ここでは、よく使われる式を導出する。譜面額PARで、満期T年、半期ごとにCが払われ、半期ごとの金利がrの債券があるとする。このとき、債券の価値は
\begin{align}
\label{d}
\sum_{t = 1}^{2T}\frac{C}{(1+r)^t} + \frac{PAR}{(1+r)^2T} &= \frac{C}{r}\{1-(1+r)^{-2T}\} + \frac{PAR}{(1+r)^2T} \nonumber \\
&=  \frac{C}{r} + \{PAR - \frac{C}{r}\}(1+r)^{-2T}
\end{align}
と書ける。式(\ref{d})から、以下がわかる。時系列モデルでの和の公式で以下がある。$r \neq 1$のとき
\begin{align}
\sum_{i = 0}{T}r^{i} = \frac{1 - r^{T+1}}{1-r}
\end{align}
となる。よって、
\begin{align}
\sum_{t = 1}^{2T}\frac{C}{(1+r)^t} &= \frac{C}{(1+r)}\sum_{t = 1}^{2T-1}\left(\frac{1}{(1+r)}\right)^{t} = \frac{C\{1 - (1+r)^{-2T}\}}{(1+r)\{1 - (1+r)^{-1}\}} \nonumber \\
&= \frac{C}{r}\{1 - (1+r)^{-2T}\}
\end{align}
\subsection{満期利回り}
\ 期間30年、毎年40ドルがついてくる、債券が1200ドルで売られているとする（200ドル譜面額より高い）。もし、その債券を譜面額で売ったなら、金利は年利8$\%$である。半期ごとの4$\%$は利札と呼ばれる。$\\ $
\ しかし、この債券は譜面額では売られない。もし、この債券を1200ドルで買ったなら、毎年8$\%$以下の金利がでる。なぜなら、1200ドルに対して毎年3$\%$の40ドルが払われる。これを現在の利回りと呼ぶ。
二つ目に満期では、1200ドルすべてではなく1000ドルが返ってくる。この現利回りは 8$\%$より低い。つまり、現在の利回りは、この年間$1.2\%$分のロスを考えていないのである。$\\ $
\ 満期までの利回り、よく利回りといわれるが、これは平均の利益率を表していて、資本損失や資本増加も含まれている。なぜならその債券は譜面額より多く払うからである。先ほどの債券では、満利回りは利益$r$を使って
\begin{align}
1200 = \frac{40}{r} + \{1000 - \frac{40}{r} \} (1+r)^{-40}
\end{align}
で求められる。式の右側は $T = 30,C =40,PAR = 1000$から出ている。これを解くのはRでできる。$\\ $
\ 結果でる$3.24\%$というのは、現在利回りの$3.33\%$より低い。また、利札も4$\%$なので、これより低い値となっている。例えば、もし、この債券を譜面額より高い額で売ったら利札は現在利回りより高くなる。そして利札は満期利益率よりも高くなる。
なぜなら、投資額すべてではなく譜面額分しか返ってこないからである。つまり以下のようになる。
\begin{align*}
price > par \Rightarrow coupon rate > current yield > yield to mature
\end{align*}
もし、譜面額より債券の売られている額が低いならすべて逆になる。
\subsubsection{満期利回りの一般的な考え方}
利息付債権の満期利回りは、満期利回り率rを用いて以下のように書ける。
\begin{align}
PRICE = \frac{C}{r} + \{PAR-\frac{C}{r}\}(1+r)^{-2T}
\end{align}
このPRICEは債券の市場値段を表す。PARは譜面額、Cは半期ごとに払われる値段、Tは満期までの期間である。$\\ $
もし、ゼロ割積ならば$C=0$となり、
\begin{align}
PRICE = PAR(1 + r)^{-2T}
\end{align}
となる。
\subsubsection{ゼロクーポンレート}
\ ゼロ割債券が満期までn年だとしたとき、これをn年のゼロクーポンレートとよび、$y_{n}$とかく。このn年ゼロクーポンレートは、今からn年後までの割引される額を計上している。
例えば1ドル払われるならば、純利益NPVは年払いなら$1/(1+y_{n})^n$となる。半期払いなら$1/(1+y_{n})^2n$となる。$\\ $
\ 利子付き債券はゼロ割積を束にしたもので、一つは期間ごとの支払い・もう一つは満期支払いである。これらは満期も違えばゼロクーポンレートも違う。
それゆえ、一束の中で、平均のゼロクーポンレートを参考にする。
\begin{enumerate}[label = 例3.\arabic*]
\item a\  ゼロクーポンレートを用いた満期債権額と値段を求める。$\\ $
\ 簡単に考えるために、半期に40ドル払われる、譜面額1000ドルで満期一年の債券を考える。半期のゼロクーポンレートを2.5$\%$/半年で、年間のゼロクーポンレートを3$\%$/半年とする。
つまりこの債券には二つの利息なし債券が組み込まれている。つまり、40ドルをT=0.5で1040ドルをT=1で考えればよい。つまり、この債券の値段は二つの利息なし債券の和で考えればよく、
以下のようになる。
\begin{align*}
\frac{40}{1.025} + \frac{1040}{(1.03)^2}
\end{align*}
つまり、満期までの利益率yは以下を解けばよい。
\begin{align*}
\frac{40}{1+y} + \frac{1040}{(1+y)^2}
\end{align*}
これを解くと、y=0.0299/半年となる。つまり、満期までの年率は5.98$\%$/年とわかる。
\end{enumerate}
\ General Formula $\\ $
\ この章では、例3.1でみた式を一般化する。半期ごとに払われる金額をCとし、譜面額をPARとする。満期までをT年とし、半期までのゼロクーポンレートをそれぞれ$y_{1},y_{2},\ldots ,y_{2T}$とする。
このとき、満期までの債券の値段は、年率yを使うと以下のように書ける。
\begin{align}
\frac{C}{1+y_{1}} + \frac{C}{(1+y_{2})^2} + \cdots + \frac{C}{(1+Y_{2T-1})^{2T-1}} + \frac{PAR+C}{(1+Y_{n})^{2T}} \nonumber \\
=\frac{C}{1+y} + \frac{C}{(1+y)^2}+\cdots + \frac{C}{(1+y)^{2T-1}} + \frac{PAR + C}{(1+y)^{2T}}
\end{align}
となる。
\subsection{期間構造（ 債券などの利回りと残存期間との関係）}
\subsubsection{導入：満期に依存した金利率}
\ 2001年1月26日時では、満期1年のT-債券の年利は4.83$\%$であり、満期30年の米国債の年利は$6.11\%$であった。これは典型的である。一般的に短期債券の利率と長期債券の利率は違う。
短期の利益率のほうが長期に比べて小さいのだ。なぜかといえば長期債券はリスキーである。つまり金利が変わると、債券自体の値段も短期に比べて変わりやすいからである。
しかし、超短期間で見たら短期の金利が長期の金利より高くなることもある。なぜなら基本的に、市場は「金利は過去を反映しているものであり、20~30年問う長い期間で高い金利を維持し続けることはない」と信じているからだ。
\subsubsection{期間構造を描く}
満期までのn年間の動きを以下で表現する。
\begin{itemize}
\item 満期n年のゼロ割債券の値段を$P(n)$と表す
\item 満期n年のゼロクーポンレートは$y_{n}$と表す。
\item i年後までの先物利率を$r_{i}$と表す。
\end{itemize}
この章で述べたように、各$\{P(1),\ldots,P(n)\},\{y_{1},\ldots,y_{n}\},\{r_{1},\ldots,r_{n}\}$は他の二つを使って表すことができる。例えば例3.11である。（略）$\\ $
\ 期間構造は、現在と満期までの間を利率が一定な期間で分けることで書き表すことができる。例えば、3年のローンは、1年ごとに構築されているローンの3年分、半年ごとに構築されているローンの6期分とかと見ることができる。
\begin{enumerate}[label = 例3.\arabic*]
\item 図3.1から先物利率から値段を測る。$\\ $
\ 譜面が1000ドル、1年間のゼロ割債券で先物利率が6%であるとすると、$\frac{1000}{1 + r_{1}} = \frac{1000}{1.06} = 943.40 = P(1)$となる。
2年間のゼロ割債券なら$\frac{1000}{(1 + r_{1})(1+r_{2})} = \frac{1000}{(1.06)(1.07)} = 881.68 = P(2)$となる。なぜなら、1年目と2年目で先物利率が異なるからだ。3年目は略。
n年間なら$\frac{PAR}{(1 + r_{1})(1+r_{2})\ldots (1+r_{n})} = P(n)$となるのは明らかであるである。
\item 満期利回りを譜面額と先物利率から出す。$\\ $
\ この例では、まず満期利回りを表3.1の金利を使って例3.2の値段から出す。もし、1年間のゼロ割積ならば、満期利回り$y_{1}$は以下の式から出せる。
\begin{align*}
\frac{1000}{1+y_{1}} = 943.40
\end{align*}
これは、$y_{1}=0.06$を表している。もし、2年間のゼロ割積ならば、以下を解くことになる。
\begin{align*}
\frac{1000}{(1+y_{2})^2} = 881.68
\end{align*}
結果、$y_{2}=0.065$となる。3年のは略。
\end{enumerate}
\ 満期利回りは先物利率から出すことができる。一般に$y_{n} = ((1+r_{1})(1+r_{2})\cdots(1+r_{n})^{1/n})-1$と書ける。つまり、相乗平均で書かれている。
\ ここで、$P_{n}$とは、譜面額1000ドルでn年のゼロ割債の値段であることを思い出すと、n年のゼロ割債の満期利回り$y_{n}$は以下のようになる。
\begin{align}
y_{n} = \{\frac{1000}{P_{n}}\}^{1/n} - 1
\end{align}
と書ける。このように、先物利率とn年後のゼロ割積の値段の二通りでかける。この二つの式から、$P_{n}$を満期利回りを使った方程式として以下のように出せる。
\begin{align}
P_{n} = \frac{1000}{(1+y_{n})^{n}}
\end{align}
\ 前にも述べたように、将来の金利を先物利率と呼ぶ。将来の取引は、将来の日に価格を調整して売ったり買ったりする。以前出てきた$r_{i}$は、将来の取引に対して確約された値であり、これらも先物利率である。$\\ $
\ 満期までの先物利率を決定する一般式として以下がある。
\begin{align*}
r_{1} &= y_{1} \\
r_{n} &= \frac{(1+y_{n})^n}{(1+y_{n-1})^{n-1}} - 1
\end{align*}
いま、わかっているのが債券の値段だけと仮定する。その場合、上記式から先物利率が計算できる。満期までの譜面額が1000ドルの債券の値段が本書図3.2に乗っている。これを参考にして計算しているのがp31。
\subsection{連続配合}
ここでは、先物利率$r_{1},r_{2},\ldots,r_{n}$が連続的に足していかれるときについて考える。この考え方を用いることで、先物利率-満期利回り-ゼロ割債券の関係が単純化される。$\\ $
\ もし、$P_{n}$を譜面額1000ドルのn年後のゼロ割債の値段だとすると、以下が成り立つ。
\begin{align}
P_{n} = \frac{1000}{exp(r_{1}+r_{2}+\cdots+r_{n})}
\end{align}
それゆえに、以下が成り立つ。
\begin{align}
\frac{(P(n-1))}{P(n)} &= \frac{exp(r_{1}+\cdots+r_{n})}{exp(r_{1}+\cdots+r_{n-1})} = exp(r_{n}) \\
&= log\frac{P(n-1)}{P(n)} = r_{n}
\end{align}
また、満期n年のゼロ割債の満期利回りは以下の方程式を解くことで得られる。
\begin{align}
P(n) = \frac{1000}{exp(n y_{n})}
\end{align}
となり、また、以下のようになることは明らかである。
\begin{align}
y_{n} = \frac{(r_{1} + \cdots + r_{n})}{n}
\end{align}
それより、$r_{i}$と$y_{i}$の関係は以下のようになる。
\begin{align*}
r_{1} &= y_{n} \\
r_{n} &= n y_{n}-(n-1)y_{n-1}
\end{align*}
と書ける。
例3.6は省略
\subsection{先物利率が連続的な場合}
\ 今までは、先物利率は年ごとに変わるが年内では一定である場合を仮定していた。この仮定は、先物利率の導入をシンプルにするために使われていたものであり、実際は非現実的である。
実際は、時間ごとに変わると設定するべきである。$\\ $
\ 期間構造をもっと現実的なものにするために、先物利率関数と呼ばれる関数$r(t)$と呼ばれるものを考える。そのため満期Tで譜面額1のゼロ割債は以下で与えられる。
\begin{align}
D(T) = exp(-\int_{0}^{T}r(t)dt)
\end{align}
この$D(T)$は割引関数と呼ばれ、どんなゼロ割債もこの関数に譜面額PARをかけることで以下のように与えられる。
\begin{align}
P(T) = PAR × D(T)
\end{align}
また、対数取ると以下のように式変形ができる。
\begin{align*}
log P(T) &= log(PAR) - \int_{0}^{T}r(t)dt \\
-\frac{d}{dT}log P(T) = r(T) \; (for\: all\: T)
\end{align*}
$D(T)$は3.6章を一般化した式であり、$r(t)$は以下のように区分間の定数関数で表される。
\begin{align*}
r(t) = r_{k} for k-1 < t \leq k
\end{align*}
区分間で定数なrは期間Tに対して以下で与えられる。
\begin{align*}
\int_{0}^{T} r(t)dt = r_{1} + r_{2} + \cdots + r_{T}
\end{align*}
となり、
\begin{align*}
exp(-\int_{0}^{T} r(t)dt) = exp(-(r_{1}+r_{2}+\cdots + r_{T}))
\end{align*}
と書ける。つまり、3.6章は3.7章の特別なケースである。また、ゼロ割債の満期利回りは以下で定義できる。
\begin{align*}
y_{T} = \frac{1}{T}\int_{0}^{T}r(t)dt
\end{align*}
上の式の右側は期間内のr(t)の平均ととらえることができる。つまり、3.7章最初の式は以下のように書ける。
\begin{align*}
D(T) = exp(-Ty_{t})
\end{align*}
つまり、満期Tのゼロ割債券の値段は、もし利率が$y_{t}$と同じでずっと一定な先物利率があるならば（実際はないけど）、それのT回和を使って書けるのである。
そうすると、別表現で以下のように書ける。
\begin{align}
y_{T} = -log\{D(T)\}/T
\end{align}
例3.7は割愛。$\\ $
また、割引関数D(T)や先物利率関数r(t)は、現在の時間に影響される。先の紹介では0と置かれていた。しかし、我々が興味があるのは時間が変化するとどのように二つの関数が変化するかである。
そのため、割引関数を改めて$D(s,T)$を時刻sでのゼロ割債の金額、譜面額1、満期までの時間をTとして定義する。同様に時刻sでの先物利率関数を$r(s,t) \; (t\geq s)$とおくと、以下のように書ける。
\begin{align}
D(s,T) = exp\{-\int_{s}^{T}r(s,t)dt\}
\end{align}
となり、満期利回りは以下のように書ける。
\begin{align*}
y(s,T) = (T-s)^{-1} \int_{s}^{T}r(s,t)dt
\end{align*}
$s= 0$のとき、$D(0,T) = D(T),y(s,T) = y_{T}$と形式的に書く。
\subsection{満期利回りの影響の受けやすさ}
\ いままでに見たように、債券というのは大変リスキーである。というのも、金利によって金額が変化するからである。このことを、金利リスクと呼ばれる。この章では、この金利リスクをを定量化する従来の方法を紹介する。$\\ $
\ (3.26)式を使うと、もし満期までの間に少しでも変化があった場合に債券の値段がどのくらい変わったかを推測する方法がある。満期までの変量$\delta$が小さくて、$y_{T}$が$y_{T}+\delta$になったとする。
となると、D(T)の変化量は$\delta$倍となる。
\begin{align}
\frac{d}{dy_{T}}exp{-Ty_{T}} \sim -Texp{-Ty_{T}} = -TD(T)
\end{align}
上記式より、満期T年のゼロ割債の式は以下のようになる。
\begin{align}
\frac{change bond price}{bond price} \sim -T × change in yield
\end{align}
となる。ここで、$\sim$は、$\lim_{\delta \rightarrow 0}$のときに$=$となることを表す。$\\ $
\ 上の式は出す価値のある式である。式の右側にあるマイナスは、我々がすでに知っているように金利の動きとは逆の動きを債券の値段はするということである。また、債券の値段の変化はTに依存することもわかる。
そして、長期間の債券は、金利リスクが短期間のに比べ高くなることもわかる。
\subsubsection{利子付き債券期間}
\ 利子付き債券は、様々な満期期間を持つゼロ割債券の束だと考えるとすでに述べている。DURと書かれる利子付き債権の期間は、払われる利子の値段と満期での譜面額の純利益によって重みづけされた期間で見られる。$\\ $
\ ここで、すべての時間Tに定数$\delta$だけ変わるとする。つまり、$y_{T}$が$y_{T} + \delta$となる。すると、3.30式から、以下が成り立つ。
\begin{align}
\frac{change bond price}{bond price} \sim -DUR × \delta
\end{align}
この式を使うと、債券が期間の中で値段が変化したことがどれくらい影響を与えたのかというのがわかる。また、上の式を書き換えることで以下が成り立つ。
\begin{align}
DUR = -\frac{1}{PRICE}×\frac{change in price}{change in yield}
\end{align}
この式を期間の定義となる。ここで債券の値段を「値段」と置き換えている。なぜこのようにしたかというと、この期間は債券だけでなく、値段が満期に依存する-例えば満期途中で他者からかった債券といったデリバティブ証券にも使えるからだ。
もし、この定義をデリバティブにも派生させるとき、証券の満期までの期間と、durationは全く関係がないのだ。つまり、durationはただの満期までの証券の値段の測りでしかないのである。例は省略。$\\ $
しかし、不幸なことに、定数$\delta$だけ変わるといったことは実際には起こらないのだ。よって、duration分析はdisfavor分析へ、value at riskはinterest rate riskを用いたduration分析へと今後の章で紹介していく。
\section{探索的データ分析}
\subsection{紹介}
\ この本は、金利等の金融データを統計的手法で分析するといった内容である。これらの値は、ランダムに変化し、それによって損失や利益が生まれる。
本書図4.1,4.2,4.3はそれぞれ金利等の時系列データのプロットをしたものである。このように時間連続にデータは株の値段や時間ごとにおこることなど何らかの量や質によって観測されたものの連続である。
また、time series plotとは、時系列順になった点のことである。$\\ $
\  たしかにどのデータでも、大きくランダムな変動が見られる一方で、ある時間で定数というのを意味するstationaryというのもみられた。特に、ある定数な平均で変動していた。
また、同様にvolality-clusteringも見られた。高い値の時と低い値の時と大きく変動するのが、各seriesで見られた。
このvolality-clusteringは、stationary性がないことを意味しているわけではなく、どちらかというと期間同士での分散に相関があると見れるのである。これは14章で明らかになる。$\\ $
\ このようなtime-seriesでは、$Y_{1},Y_{2},\ldots$等、各々確率変数としての連続としてみることができる。それぞれをCDFといい、Fと呼ばれる。Fはtime-series間で変化するものの、期間内ではstationary性から定数であると仮定されている。
Fはまた、周辺分布関数と呼ぶ。つまり、$s \neq t$において、$Y_{s}$はほかの確率変数に影響を与えないことを意味し、つまり周辺分布を構築する際に相関は無視してもよいということがわかる。
よって、周辺分布関数は無条件分布として呼ばれる。自己相関やvolality-clusteringについては後の章で述べる。$\\ $
\ この章では、周辺分布を推測、モデリングする方法を探索し、特にグラフから発見する方法について述べる。
\subsection{カーネル密度推定}
\ 周辺分布CDF Fが確率密度関数Fを持つとする。ヒストグラムは、確率密度関数を推測するのにシンプルかつ大変知られている方法である。図4.4の(a)をみると、30個の幅でS＆P 500の対数利益率のヒストグラムとなっている。
ここではいくつか外れ値が観測でき、例えば、1987-10-19にブラックマンデーで利率が-0.23になった。つまり、市場は23%の利益をたった一日で失ったのである。外れ値は、x軸を拡張したりしない限りヒストグラムでは観測しにくかったり不可能である。
なぜ、外れ値が観測しにくいかというと、サンプルサイズが大きいからである。例えば、1000個もサンプルがあれば、頻度の少ない幅のデータは見にくいのである。
図4.4(b)は、確率が高いところに注視している。当然横軸は30個の幅よりかは少ない。$\\ $
\ しかし、ヒストグラムはかなり粗い推定量である。典型的なヒストグラムは、密度関数よりも大きな変動をする。そして、数や幅の値に大きく依存される。（図4.4のc）
ここで、優れた推定法として、カーネル密度推定KDEがある。これは、カーネル関数から由来していて、Kと書かれている。このカーネル関数とは、確率密度関数でx = 0に対して対称なものである。一般的に、$Y_{1},\ldots,Y_{n}$
に対して、Kで与えられる以下のような式である。
\begin{align}
\hat{f}(y) = \frac{1}{nb}\sum_{i=1}{n}K\left(\frac{y - Y_{i}}{b}\right)
\end{align}
ただし、このbは  帯域幅とよばれ、推定量の結果から推定されるものである。$\\ $
\ 図4.5はカーネル密度関数を、標準正規分布からの六つの乱数を取ってきて作成したものに対して構築したものである。少ないサンプル数は、見栄えをよくするのに必要な一方で、正規分布関数を適切に表現することはできない。
6つのデータ点が、図の下の部分に縦線として入っている。これをrugと呼ぶ。例えば、帯域幅は0.4で最大値を取るため、6本の点線は、標準偏差が0.4となる正規分布を1/6倍したものとなり、各データ点の中間値にそってひかれている。$\\ $
\ bが小さい時は、推定密度関数を正しい密度関数により近づけていくためにある。しかし、このbは変動の大きい確率変数となる。これは、図4.5の下で、帯域幅のなかで頂点が半分になっているところをを見ればわかる。
反対に、bが大きい時は、確率変数の値をわかりにくくするものの、真の確率分布に近づきやすくなる。
別の表現をすると、bが小さい時は、カーネル密度推定は期待値に近づくものの分散が大きく、逆の場合は、分散は小さいものの期待値には離れてしまう。$\\ $
\ つまり、bはバイアスと分散でトレードオフの関係になっている。bの真値はサンプル数nと母集団の密度関数に依存するものの、もちろん後者はわからない。しかし推定はできる。ざっくりいうと、滑らかでない密度関数には、小さい帯域幅となる。
幸運なことに、多くのサンプルは、bを自動的に与えることとなり、それはつまり母集団の密度関数を粗く推定できるということなのだ。結果として、現在の統計ソフトでは、自動的に帯域幅を決定できる。
しかし、自動的に帯域幅を決定できる機械は、絶対な答えではなく、推定された密度関数は、必要ならば以下のような手段で視覚的にも確認するべきである。$\\ $
\ 図4.6に書かれてる立体関数は、Rのdensity関数に組み込まれているデフォルトの帯域幅である。図の破線と点線の関数はそれぞれ、デフォルトの帯域幅を1/3倍と3倍にしたものである。
Rで調整されるパラメータは、デフォルトの帯域幅を何倍とするかというものであり、以下の図では1,1/3,3である。1倍したものの立体感数は、適度な滑らかさを持つ。それに比べて、1/3倍されたものは、多くの確率変数に影響されているためごつごつしている。
このような曲線は、オーバーフィッティング（や過学習？）等で呼ばれる。一方、3倍されたものは大変なめらかであるが、0付近で推定された値が下回っている。これは、バイアスがかかっている証拠である。これは、過小学習等で呼ばれる。
過剰学習では、データに過剰に適合させてしまうことで確率変数の影響を受けやすくしまっているいっぽうで、過小学習では、データを十分に適合できていないために、真のデータの特徴をつかめていないということになってしまう。
つまり、過剰学習と過小学習ではそれぞれ、バイアスとバリアンスのトレードオフの関係が悪いことを表している。過剰学習ではバリアンスが、過小学習ではバイアスがかかりすぎているのである。$\\ $
\ 自動的に帯域幅を決めるのは大変便利であるが、不思議なところは何もなく（？）、自動的に決まったものをスタートの値としてよりよい帯域幅を決めることもある。これを調整したパラメータ（adjust パラメータ）という。一般的に調整したものは、1に近づく。というのも1/3や3に近づくと、
よりバイアスやバリアンスが強調されてしまうからだ。$\\ $
\ カーネル密度推定では、パラメータを統計量で書くモデル（parametric statistical model)を述べるときに使われる。図4.6のような密度関数を推定したものは、鈴形をしている。これは、正規分布が適したモデルであろうということを述べている。
実際、図4.7でadjust = 1としたときのカーネル密度関数と正規分布は一致する。panel(a)を見ると、正規分布の平均分散と、サンプルから出された平均分散が一致することがわかる。勿論、カーネル密度推定と正規分布は幾分か似てないところもある。
理由としては、外れ値が出てきたときそれがサンプルの標準偏差に影響を与えていることであり、その結果、調整した正規分布は、データの中心で乖離していることがわかる。
panel(b)では、カーネル推定と正規分布がより似通っている。ここでは、正規分布に外れ値の影響をより受けにくくしたロバスト推定量が使われている。つまり、平均はサンプルの中央値から推測されていて、MAD（絶対中央編差)の推定量に標準偏差が使われている。
MAD推定量は、中央値からの絶対偏差をだしている一方で、通常の母集団の標準偏差を推定するようにスケーリングされている。サンプルの標準偏差は0.011であるが、MADは0.0079と小さくなっている(Rのsd関数とmad関数で出すことができる。)
パネル(b)では、正規分布とカーネル推定では幾分か乖離があり、この後示されるように、t分布だとより当てはまりが良い。ロバスト推定量はそれ自身が非正規でなければならないという指定がある。$\\ $
\ カーネル密度推定を使ってサンプルのデータを良いモデルに推測する - つまりモデルのパラメータをよいものに推測する- 時におこる問題についてみてきた。正規分布の四分位範囲のプロットは、サンプルからの統計的な分布と比較するのによい手法である。$\\ $
\ カーネル密度推定は計算しやすい一方で問題もある。特に、分布の裾が雑なのだ。これについての改善方法は4.8章で述べる。
\subsection{順序統計量・経験的累積分布関数・経験的分位点}
\ 今$Y_{1} \ldots Y_{n}$を確率分布CDF Fからの確率変数とする。この章では、Fやその四分位点を推定する。標本や経験CDF $F_{n}$は$y$以下のサンプルの比率によって定義される。例えば、40このサンプルのうち、10個が3以下であるなら
$F_{n} = 0.25$となる。一般的には、
\begin{align}
F_{n}(y) = \frac{n}{\sum_{i = 1}^{n}I\{Y_{i} \leq y\}}
\end{align}
となる。ここでIは指示関数である。つまり、分子では、y以下になる標本を数えているのだ。図4.8は、標準正規分布から150この乱数を取っている。真のCDF($\phi$)も同様に出されている。
サンプルのCDFは、EDFとも呼ばれ、真のCDFとは異なる。というのも確率変数だからである。ecdh()はサンプルCDFを計算してくれる。コードは以下略。$\\ $
\ $Y_{(1)},\ldots,Y_{(n)}$は、$Y_{1} \ldots Y_{n}$の値を昇順に並び替えたものである。順序統計量の番号に()が振られているのは、普通の確率変数の番号と区別するためである。
例えば、$Y_{1}$は最初に観測された確率変数である一方、$Y_{(1)}$は最も小さい値を取った確率変数となる。経験分位点は、書く人によって定義がわかれるものの大体をいうとq-経験分位点は、
kが四捨五入されたqnによって定められたもとでの$Y_{(k)}$である。ここで、丸め込むか切り上げるか切り下げるか等は人によって分かれる。関数ではquantile()というのがある。
これには、9種類あって、本書参考。金融データでは、大量の標本があるためどの関数を使ってもある程度結果は同じになるが、サンプル数が少ないとはっきりと違う値を返す。$\\ $
\ q番目の分位点は、100*q$\%$点とも呼ばれる。例えば、0.5 経験分位点は50％点であり、中央値と呼ばれる。その他四分位点の説明は端折る。
\subsubsection{経験分位点への中心極限定理の適用}
多くの推定量では、中心極限定理が成り立つ。以下の定理で、これが経験分位点でも成り立つことが示されている。
\begin{enumerate}[label = 結果4.\arabic*]
\item 今、$Y_{1},\ldots,Y_{n}$が独立同一にCDF Fに従うと仮定する。このとき、Fが確率密度関数fを持つと仮定する（つまり、fは連続で、$F^{-1}(q)$が正である)。このとき、大数nにたいして
q経験分位点の分布は、平均$F^{-1}(q)$、分散が以下の式で表される正規分布と等しくなる。
\begin{align}
\frac{q(1-q)}{n[f\{F^{-1}(q)\}]}
\end{align}
\end{enumerate}
\ この定理は、すぐに適用できるものではない。例えば、母集団の分位点を構築する際に、$f\{F^{-1}(q)\}$が道だからである。しかし、fはカーネル密度推定から推定でき、$F^{-1}(q)$も標本分位点から推測できる。、その代わり、信頼区間を構築するためにはリサンプリングをしなければならない。これは6章で述べる。
\subsubsection{正規確率プロット}
\ 多くの統計モデルは、ランダム標本は正規分布からくると仮定されている。正規分布プロットは、この仮定を確認するのに使えて、もしこの仮定が誤りならどのくらい正規分布から乖離しているかを調べるのに使える。
もし、この仮定が正しいならq番目の分位点は大体$\mu + \sigma \Phi^{-1}(q)$と等しくなる。それゆえサンプル変動を除くと、サンプルの分位点と$\Phi^{-1}$は近づく。
一つの生起確率プロットとして、$Y_{i}$と$\Phi^{-1}\{ (i - -1/2)/n \}$をプロットするのがある。この図の中には、それぞれ(i-1/2)/n個のサンプルと分位点がプロットされる。
分子iから1/2を引くのは、i = n の時に$\Phi^{-1}(1) = \infty$となるのを避けるためである。$\\ $
\ 直線からの逸脱は、非正規性を示している。ほかの正規確率プロットは、例えば正規性を仮定したもので順序統計量をプロットしたものと、それらの期待値の比較である。ただしこれは、サンプル数が大きくなると極端な裾を除いて大体一致してしまう。$\\ $
\ Rの関数を使うときに、x軸の値を求めたいのかy軸の値を求めたいのかで使うものが変わる。ここでqqplotとかqqnormの説明があるが省略。$\\ $
\ もし、正規確率プロットが非線形なら、標本の特徴をチェックするためにそのプロットが凹か凸かを見る。凸性は図4.9のa,凹性は図4.9のbを見ればわかる。凹凸なグラフは図4.9c,dでみれる。説明は省略。$\\ $
\ 凸、凹、凸凹、凹凸な正規プロットは、それぞれ、左歪曲、右歪曲、裾の重い、軽いを意味している。これは、横軸にサンプル分位点がプロットされているときに適応されているものであり、もし縦軸にサンプル分位点がプロットされいるなら、それぞれ対応させなければならない。
分布の裾は、中心から離れている。一般的に理にかなっている裾の定義は、$(-\infty,\mu - 2\sigma) \cup (\mu + 2\sigma,\infty)$であるが、このときに$\mu \pm 2\sigma$を使っているのは勝手に取ってきている。
また、$\mu,\sigma$はそれぞれ平均分散なので、中央値とMAD推定量で置き換えてもよく、その場合裾が重い特徴を捉えきれなくなる。$\\ $
\ 図10を見ると、正規分布からの20,150,1000個とってきたサンプルの正規確率をプロットしている。正規分布に従う確率変数の典型的なプロットを合わらすために、各サンプルサイズに対して二つの独立したサンプルが示されている。
確率変数のため、このプロットは線形に近い物にしかならない。より小さいサンプルサイズでは、通常の正規分布からのデータに比べ線形からの多少の逸脱が観測される。サンプルサイズが多ければ、プロットが多様性を持っていた場合、裾の部分が極端になる。$\\ $
多くの場合、そのプロットがきちんと線形に従っているかどうかを判断しやすくするために正規プロットには参考線がひかれる。よく引かれる線として、第一四分位店と第三四分位点を結んだものである（qqline)。
他にも、最小二乗法でfitした線を引くとか、外れ値の影響を避けるためにいくつかの分位点の部分集合（例えば、0.1 ~ 0.9までのすべての分位点に引く等がある。$\\ $
\ 図4.11には、150このサンプルを対数正規分布からとってきたものがプロットされている。標準偏差には1,0.5,0.2が使われている。図4.11の凸型をみると、グラフが左によっている。(right skewness)
特に標準偏差が大きければ大きいほど顕著になっている。一方標準偏差が小さいとサンプルが少ない場合あまりこの傾向がみられない。$\\ $
図4.12を見ると、自由度が4,10,30についてt分布からのサンプルをプロットしている。最初の二つは裾の重い分布で、つまり正規分布を仮定したときよりも右端と左端の値がより顕著に出ている。図を見れば、自由度4のグラフのほうが自由度10のグラフより顕著にこの傾向が出ている。
一方自由度が30あると、正規分布とあまり変わらないグラフとなっている。これはt分布の一般的な性質（自由度が小さいほど裾が重くなる）である。また、t分布は対称なグラフなので片方にゆがむこともない。
左右対称で裾の重いグラフというのは金融ではよくあることで、株の利益率やほかの市場データでt分布というのは道理にかなったモデルである。$\\ $
\ 正規プロットでは、ここで説明したようなパターン以外にもより複雑な挙動を示すこともある。図4.13で示されるように三峰な分布からサンプルを取ってきた場合である。QQプロットの代わりとして凸性や凹性を見るためにKDE（カーネル密度推定)によって調査する方法がある。
ここでは、KDEは三峰性を明確にできる。マルチモデルの場合は、現実では珍しく、複数の違う集団のデータの集まりとしてとらえる。$\\ $
\ しかし、正規プロットは本当にそのデータが正規分布であると決めつけてよいかどうかを判断するのには、特にサンプルが少ない時には難しいことが多い。例えば、図4.10では、線形な形をしているものとそうでないものがある。
もし、そのデータが正規分布からとってきているとわからなかったら、正規プロットの図に慣れていなければ、この図は正規分布からとってきてますとはわからないであろう。この場合、正規性のテストが4.4章にあり、これが大変便利である。
\subsubsection{半分だけ正規分布な確率プロット}
半正規確率プロットとは、正規確率プロットの一種であり正規分布より外れ値を見つけるのに役たつ。例えば、$Y_{1} ~ Y_{n}$まで得られたとして、標本平均との乖離を調べて、異常性のあるデータを見つけたい。半正規確率プロットは、標準正規分布に絶対値を付けた|Z|についての分位点を見る。
もう少し厳密に言うなら、 $\Phi^{-1}{(n + i)/(2n + 1)}$から得られるデータに絶対値を付けて順を付けたものとなる。Rだとhalfnormやnlabとか使うとできる。$\\ $
\ 図4.14は、DMとdollarの交換レートを半正規プロットしたものである。このとき、1447番目のデータと217番目のデータが外れ値となっている。rlabとかでわかる。コード参照。

\end{document}
